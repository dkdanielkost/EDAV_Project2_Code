z38 = dat$phi[ , , offset38]
z39 = dat$phi[ , , offset39]
z40 = dat$phi[ , , offset40]
z41 = dat$phi[ , , offset41]
z42 = dat$phi[ , , offset42]
z43 = dat$phi[ , , offset43]
z44 = dat$phi[ , , offset44]
z45 = dat$phi[ , , offset45]
z46 = dat$phi[ , , offset46]
z47 = dat$phi[ , , offset47]
z48 = dat$phi[ , , offset48]
z49 = dat$phi[ , , offset49]
z50 = dat$phi[ , , offset50]
z51 = dat$phi[ , , offset51]
z52 = dat$phi[ , , offset52]
z53 = dat$phi[ , , offset53]
z54 = dat$phi[ , , offset54]
z55 = dat$phi[ , , offset55]
z56 = dat$phi[ , , offset56]
z57 = dat$phi[ , , offset57]
z58 = dat$phi[ , , offset58]
z59 = dat$phi[ , , offset59]
z60 = dat$phi[ , , offset60]
z61 = dat$phi[ , , offset61]
z62 = dat$phi[ , , offset62]
z63 = dat$phi[ , , offset63]
z64 = dat$phi[ , , offset64]
d <- data.frame()
d <- rbind(z_14[,14][41],
z_13[,14][41],
z_12[,14][41],
z_11[,14][41],
z_10[,14][41],
z09[,14][41],
z08[,14][41],
z07[,14][41],
z06[,14][41],
z05[,14][41],
z04[,14][41],
z03[,14][41],
z02[,14][41],
z01[,14][41],
z0[,14][41],
z1[,14][41],
z2[,14][41],
z3[,14][41],
z4[,14][41],
z5[,14][41],
z6[,14][41],
z7[,14][41],
z8[,14][41],
z9[,14][41],
z10[,14][41],
z11[,14][41],
z12[,14][41],
z13[,14][41],
z14[,14][41],
z15[,14][41],
z16[,14][41],
z17[,14][41],
z18[,14][41],
z19[,14][41],
z20[,14][41],
z21[,14][41],
z22[,14][41],
z23[,14][41],
z24[,14][41],
z25[,14][41],
z26[,14][41],
z27[,14][41],
z28[,14][41],
z29[,14][41],
z30[,14][41],
z31[,14][41],
z32[,14][41],
z33[,14][41],
z34[,14][41],
z35[,14][41],
z36[,14][41],
z37[,14][41],
z38[,14][41],
z39[,14][41],
z40[,14][41],
z41[,14][41],
z42[,14][41],
z43[,14][41],
z44[,14][41],
z45[,14][41],
z46[,14][41],
z47[,14][41],
z48[,14][41],
z49[,14][41],
z50[,14][41],
z51[,14][41],
z52[,14][41],
z53[,14][41],
z54[,14][41],
z55[,14][41],
z56[,14][41],
z57[,14][41],
z58[,14][41],
z59[,14][41],
z60[,14][41],
z61[,14][41],
z62[,14][41],
z63[,14][41],
z64[,14][41])
da <- as.data.frame(x=d)
f <- seq(as.Date("2003/9/08"), as.Date("2003/11/25"), "day")
dab <- cbind(da, f)
colnames(dab) <- c("Pressure","Date")
ggplot(dab, aes(Date, Pressure)) +
geom_point() +
geom_line() +
geom_vline(xintercept = 12313, colour="blue") +
#geom_vline(xintercept = 12319, colour="blue") +
geom_vline(xintercept = 12375, colour="blue") +
#geom_vline(xintercept = 12378, colour="blue") +
labs(title="Pressure Level Between Floods in USA") +
labs(x="2003") +
theme_classic() +
geom_text(data=subset(dab, Date ==  "2003-09-18" | Date ==  "2003-11-19"),
aes(label=Date), colour = "red")
```
The first thing you might notice in the graph is that the pressure level seems to be trending downward over the two-month period starting in September and ending in November. I think one possible explanation for this is the change in seasons. Looking specifically at the pressure level in the days leading up to the beginning of the flood, you’ll notice that there was a sharp change in the pressure level. In September, starting on the 15th, the pressure level drops sharply and then increases sharply. In November, starting on the 16th, you can see that the pressure level drops sharply in the days leading up to the beginning of the flood.
At first glance, these findings might seem interesting, but when you look at the pressure level day-by-day in the days between the two floods, you see that there are many sharp increases and decreases in the pressure level. Since there are know other recorded floods in this region during this time frame I don’t think you can completely attribute the flooding and storms in September in November to the change in pressure level in the days leading up to the events. If anything, the pressure level is one factor that contributed to the rain and then flooding in these regions.
library(gdata)
library(ggplot2)
library(plyr)
library(xlsx)
library(ncdf)
library(ncdf.tools)
library(chron)
library(RColorBrewer)
library(lattice)
library(ncdf4)
library(RNetCDF)
setwd("/Users/johnsibilla/desktop/EDAV Project 2")
df <- read.csv("GlobalFloodsRecord.csv")
col.nacheck = data.frame(colSums(is.na(df)))
#Remove if country is not listed
df = df[complete.cases(df$Country),]
col.nacheck2 = data.frame(colSums(is.na(df)))
#Only Removed about 330 Lines
#Trim spaces commats etc
trim <- function (x) gsub("^\\s+|\\s+$|^\\.+|\\.[^.]*$|\\,", "", x)
df$Country = trim(df$Country)
a <- df[-which(df$Began == "" | df$Began == "#N/A"), ]
a$Began = as.character(a$Began)
elems <- unlist( strsplit(a$Began , "-", fixed = TRUE ) )
m <- matrix( elems , ncol = 3 , byrow = TRUE )
colnames(m) <- c('day', 'month', 'year')
by_year <- cbind(a, m)
by_year$year = as.numeric(levels(by_year$year))[as.integer(by_year$year)]
dat03 <- subset(by_year, year == 03,
select=c(Register..:year))
dat03$month=as.character(dat03$month)
dat03$month[dat03$month=='Jan'] <- 1
dat03$month[dat03$month=='Feb'] <- 2
dat03$month[dat03$month=='Mar'] <- 3
dat03$month[dat03$month=='Apr'] <- 4
dat03$month[dat03$month=='May'] <- 5
dat03$month[dat03$month=='Jun'] <- 6
dat03$month[dat03$month=='Jul'] <- 7
dat03$month[dat03$month=='Aug'] <- 8
dat03$month[dat03$month=='Sep'] <- 9
dat03$month[dat03$month=='Oct'] <- 10
dat03$month[dat03$month=='Nov'] <- 11
dat03$month[dat03$month=='Dec'] <- 12
USA03 <- subset(dat03, Country == "USA",
select=c(Register..:year))
qplot(month, data=USA03, geom="bar", fill=month) +
#labs(title = "Floods by Month in USA, 2003") +
scale_x_discrete(limits=c(1,2,3,4,5,6,7,8,9,10,11,12)) +
labs(x="Month") +
labs(y="Total") +
theme_classic() +
theme(legend.position="none")
library(gdata)
library(ggplot2)
library(plyr)
library(xlsx)
library(ncdf)
library(ncdf.tools)
library(chron)
library(RColorBrewer)
library(lattice)
library(ncdf4)
library(RNetCDF)
setwd("/Users/bobminnich/Documents/Columbia/Courses/DataVisualization/Homework2/EDAV_Project2_Code")
df <- read.csv("GlobalFloodsRecord.csv")
col.nacheck = data.frame(colSums(is.na(df)))
#Remove if country is not listed
df = df[complete.cases(df$Country),]
col.nacheck2 = data.frame(colSums(is.na(df)))
#Only Removed about 330 Lines
#Trim spaces commats etc
trim <- function (x) gsub("^\\s+|\\s+$|^\\.+|\\.[^.]*$|\\,", "", x)
df$Country = trim(df$Country)
a <- df[-which(df$Began == "" | df$Began == "#N/A"), ]
a$Began = as.character(a$Began)
elems <- unlist( strsplit(a$Began , "-", fixed = TRUE ) )
m <- matrix( elems , ncol = 3 , byrow = TRUE )
colnames(m) <- c('day', 'month', 'year')
by_year <- cbind(a, m)
by_year$year = as.numeric(levels(by_year$year))[as.integer(by_year$year)]
dat03 <- subset(by_year, year == 03,
select=c(Register..:year))
dat03$month=as.character(dat03$month)
dat03$month[dat03$month=='Jan'] <- 1
dat03$month[dat03$month=='Feb'] <- 2
dat03$month[dat03$month=='Mar'] <- 3
dat03$month[dat03$month=='Apr'] <- 4
dat03$month[dat03$month=='May'] <- 5
dat03$month[dat03$month=='Jun'] <- 6
dat03$month[dat03$month=='Jul'] <- 7
dat03$month[dat03$month=='Aug'] <- 8
dat03$month[dat03$month=='Sep'] <- 9
dat03$month[dat03$month=='Oct'] <- 10
dat03$month[dat03$month=='Nov'] <- 11
dat03$month[dat03$month=='Dec'] <- 12
USA03 <- subset(dat03, Country == "USA",
select=c(Register..:year))
qplot(month, data=USA03, geom="bar", fill=month) +
#labs(title = "Floods by Month in USA, 2003") +
scale_x_discrete(limits=c(1,2,3,4,5,6,7,8,9,10,11,12)) +
labs(x="Month") +
labs(y="Total") +
theme_classic() +
theme(legend.position="none")
a <- df[complete.cases(df$Began), ]
a$Began = as.character(a$Began)
elems <- unlist( strsplit(a$Began , "-", fixed = TRUE ) )
m <- matrix( elems , ncol = 3 , byrow = TRUE )
colnames(m) <- c('day', 'month', 'year')
by_year <- cbind(a, m)
by_year$year = as.numeric(levels(by_year$year))[as.integer(by_year$year)]
dat03 <- subset(by_year, year == 03,
select=c(Register..:year))
dat03$month=as.character(dat03$month)
dat03$month[dat03$month=='Jan'] <- 1
dat03$month[dat03$month=='Feb'] <- 2
dat03$month[dat03$month=='Mar'] <- 3
dat03$month[dat03$month=='Apr'] <- 4
dat03$month[dat03$month=='May'] <- 5
dat03$month[dat03$month=='Jun'] <- 6
dat03$month[dat03$month=='Jul'] <- 7
dat03$month[dat03$month=='Aug'] <- 8
dat03$month[dat03$month=='Sep'] <- 9
dat03$month[dat03$month=='Oct'] <- 10
dat03$month[dat03$month=='Nov'] <- 11
dat03$month[dat03$month=='Dec'] <- 12
USA03 <- subset(dat03, Country == "USA",
select=c(Register..:year))
qplot(month, data=USA03, geom="bar", fill=month) +
#labs(title = "Floods by Month in USA, 2003") +
scale_x_discrete(limits=c(1,2,3,4,5,6,7,8,9,10,11,12)) +
labs(x="Month") +
labs(y="Total") +
theme_classic() +
theme(legend.position="none")
month
dat03
View(USA03)
test = filter(df,Country == "USA" & Year == "2003")
View(test)
library(gdata)
library(ggplot2)
library(plyr)
library(xlsx)
library(ncdf)
library(ncdf.tools)
library(chron)
library(RColorBrewer)
library(lattice)
library(ncdf4)
library(RNetCDF)
setwd("/Users/bobminnich/Documents/Columbia/Courses/DataVisualization/Homework2/EDAV_Project2_Code")
df <- read.csv("GlobalFloodsRecord.csv")
col.nacheck = data.frame(colSums(is.na(df)))
#Remove if country is not listed
df = df[complete.cases(df$Country),]
col.nacheck2 = data.frame(colSums(is.na(df)))
#Only Removed about 330 Lines
#Trim spaces commats etc
trim <- function (x) gsub("^\\s+|\\s+$|^\\.+|\\.[^.]*$|\\,", "", x)
df$Country = trim(df$Country)
#a <- df[-which(df$Began == "" | df$Began == "#N/A"), ]
a <- df[complete.cases(df$Began), ]
a$Began = as.character(a$Began)
elems <- unlist( strsplit(a$Began , "-", fixed = TRUE ) )
m <- matrix( elems , ncol = 3 , byrow = TRUE )
colnames(m) <- c('day', 'month', 'year')
by_year <- cbind(a, m)
by_year$year = as.numeric(levels(by_year$year))[as.integer(by_year$year)]
dat03 <- subset(by_year, year == 03,
select=c(Register..:year))
dat03$month=as.character(dat03$month)
dat03$month[dat03$month=='Jan'] <- 1
dat03$month[dat03$month=='Feb'] <- 2
dat03$month[dat03$month=='Mar'] <- 3
dat03$month[dat03$month=='Apr'] <- 4
dat03$month[dat03$month=='May'] <- 5
dat03$month[dat03$month=='Jun'] <- 6
dat03$month[dat03$month=='Jul'] <- 7
dat03$month[dat03$month=='Aug'] <- 8
dat03$month[dat03$month=='Sep'] <- 9
dat03$month[dat03$month=='Oct'] <- 10
dat03$month[dat03$month=='Nov'] <- 11
dat03$month[dat03$month=='Dec'] <- 12
USA03 <- subset(dat03, Country == "USA",
select=c(Register..:year))
test = filter(df,Country == "USA" & Year == "2003")
qplot(factor(month), data=test, geom="bar", fill=month) +
#labs(title = "Floods by Month in USA, 2003") +
scale_x_discrete(limits=c(1,2,3,4,5,6,7,8,9,10,11,12)) +
labs(x="Month") +
labs(y="Total") +
theme_classic() +
theme(legend.position="none")
qplot(factor(month), data=test, geom="bar", fill=month) +
#labs(title = "Floods by Month in USA, 2003") +
scale_x_discrete(limits=c(1,2,3,4,5,6,7,8,9,10,11,12)) +
labs(x="Month") +
labs(y="Total") +
theme_classic() +
theme(legend.position="none")
qplot(factor(Month), data=test, geom="bar", fill=month) +
#labs(title = "Floods by Month in USA, 2003") +
scale_x_discrete(limits=c(1,2,3,4,5,6,7,8,9,10,11,12)) +
labs(x="Month") +
labs(y="Total") +
theme_classic() +
theme(legend.position="none")
qplot(factor(Month), data=test, geom="bar", fill=Month) +
#labs(title = "Floods by Month in USA, 2003") +
scale_x_discrete(limits=c(1,2,3,4,5,6,7,8,9,10,11,12)) +
labs(x="Month") +
labs(y="Total") +
theme_classic() +
theme(legend.position="none")
test_month = group_by(test,Month)
test_month
View(test_month)
test3 =   summarize(test_month , n())
test3
setwd("/Users/bobminnich/Documents/Columbia/Courses/DataVisualization/Homework2/EDAV_Project2_Code")
library(ggplot2)
library(maps)
df = readRDS("GlobalFloodsRecord.rds")
df$Displaced = as.numeric(df$Displaced)
df$Dead = as.numeric(df$Dead)
df$Country = as.factor(df$Country)
df$Centroid.X = as.numeric(as.character(df$Centroid.X))
df$Centroid.Y = as.numeric(as.character(df$Centroid.Y))
df$Magnitude..M... = as.numeric(as.character(df$Magnitude..M...))
df$Affected.sq.km = as.numeric(as.character(df$Affected.sq.km))
df$Duration.in.Days = as.numeric(as.character(df$Duration.in.Days))
df$Severity.. = as.numeric(as.character(df$Severity..))
df$M.6 = as.numeric(as.character(df$M.6))
df$M.4 = as.numeric(as.character(df$M.4))
df = df[,-c(31:36)]
startend = read.csv("Start_End.csv", header = TRUE)
df$Began = as.Date(startend$Start, "%d-%b-%y")
df$Ended = as.Date(startend$End, "%d-%b-%y")
month_clean <- data.frame(do.call('rbind', strsplit(as.character(df$Began),"-")))
colnames(month_clean) = c("Year", "Month", "Day")
df$Year = as.factor(month_clean$Year)
df$Month = as.factor(month_clean$Month)
df$Day = as.factor(month_clean$Day)
world_map <- map_data("world")
p <- ggplot() + coord_fixed() + xlab("") + ylab("")
base_world_messy <- p + geom_polygon(data=world_map, aes(x=long, y=lat, group=group),
colour="light green", fill="light green")
cleanup <-
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'white'),
axis.line = element_line(colour = "white"), legend.position="none",
axis.ticks=element_blank(), axis.text.x=element_blank(),
axis.text.y=element_blank())
base_world <- base_world_messy + cleanup
df2 = df[df[,'Year']==2003,]
map_data = base_world +geom_point(data=df, aes(x=Centroid.X, y=Centroid.Y), colour="Red",fill="Pink",pch=21, size=2, alpha=I(0.5))
map_data = map_data + ggtitle("World Map on all the flood events")
map_data
library(stats)
df2 = df[df[,'Year']==2003,]
df$Main.cause = as.factor(df$Main.cause)
df3 = df2
df3$Main.cause = as.character(df3$Main.cause)
df3$Main.cause[df3$Main.cause=='Rain and snow'] = "Rain and Snow Melt"
df3$Main.cause[df3$Main.cause=='Snowmelt'] = "Snow Melt"
MainCause = df3$Main.cause
pca <- prcomp(df3[,c('Duration.in.Days','Dead','Displaced','Severity..', 'Affected.sq.km','Magnitude..M...','Centroid.X', 'Centroid.Y', 'M.6', 'M.4')],scale=TRUE,center=TRUE)
plot(pca, type = "l",main="PCA for year 2003")
summary(pca)
library(devtools)
#install_github("vqv/ggbiplot",force = TRUE)
library(ggbiplot)
g <- ggbiplot(pca, obs.scale = 1, var.scale = 1, groups = MainCause,
ellipse = TRUE, circle = TRUE)
g <- g + scale_color_discrete(name = '')
g <- g + theme(legend.direction = 'horizontal',
legend.position = 'top')
print(g)
install.packages("ggbiplot")
library(devtools)
install_github("vqv/ggbiplot",force = TRUE)
library(ggbiplot)
g <- ggbiplot(pca, obs.scale = 1, var.scale = 1, groups = MainCause,
ellipse = TRUE, circle = TRUE)
g <- g + scale_color_discrete(name = '')
g <- g + theme(legend.direction = 'horizontal',
legend.position = 'top')
print(g)
install.packages("scales")
install.packages("scales")
install.packages("scales")
library(ggbiplot)
g <- ggbiplot(pca, obs.scale = 1, var.scale = 1, groups = MainCause,
ellipse = TRUE, circle = TRUE)
g <- g + scale_color_discrete(name = '')
g <- g + theme(legend.direction = 'horizontal',
legend.position = 'top')
print(g)
df$Main.cause = as.factor(df$Main.cause)
df4 = df
df4$Main.cause = as.character(df4$Main.cause)
#df4$Main.cause[df4$Main.cause=='Rain and snow'] = "Rain and Snow Melt"
#df4$Main.cause[df4$Main.cause=='Snowmelt'] = "Snow Melt"
#nrow(df3[df3$Main.cause=='Dam Failure',])
#unique(df4$Main.cause)
df4$Main.cause[df4$Main.cause=='Snowmelt'] = "Snow Melt"
df4$Main.cause[df4$Main.cause=='snowmelt'] = "Snow Melt"
df4$Main.cause[df4$Main.cause=='heavy Rain'] = "Heavy Rain"
df4$Main.cause[df4$Main.cause=='heavy rain'] = "Heavy Rain"
df4$Main.cause[df4$Main.cause=='Heavy  Rain'] = "Heavy Rain"
df4$Main.cause[df4$Main.cause=='Heavy rain'] = "Heavy Rain"
df4$Main.cause[df4$Main.cause=='HeavyRain'] = "Heavy Rain"
df4$Main.cause[df4$Main.cause=='Rain and snow'] = "Rain and Snow Melt"
df4$Main.cause[df4$Main.cause=='Rain and snowmelt'] = "Rain and Snow Melt"
df4$Main.cause[df4$Main.cause=='Snowmelt and Heavy Rain'] = "Rain and Snow Melt"
df4$Main.cause[df4$Main.cause %in% grep("^Tropical Storm", unique(df4$Main.cause), value = TRUE)] = "Tropical"
df4$Main.cause[df4$Main.cause %in% grep("^Typhoon", unique(df4$Main.cause), value = TRUE)] = "Typhoon"
df4$Main.cause[df4$Main.cause %in% grep("Monsoon", unique(df4$Main.cause), value = TRUE)] = "Monsoon"
df4$Main.cause[df4$Main.cause %in% grep("monsoon", unique(df4$Main.cause), value = TRUE)] = "Monsoon"
df4$Main.cause[df4$Main.cause %in% grep("^Hurricane", unique(df4$Main.cause), value = TRUE)] = "Hurricane"
df4$Main.cause[df4$Main.cause %in% grep("^Tropical Cyclone", unique(df4$Main.cause), value = TRUE)] = "Tropical"
df4$Main.cause[df4$Main.cause %in% grep("jam", unique(df4$Main.cause), value = TRUE)] = "Ice Jams"
df4$Main.cause[df4$Main.cause %in% grep("Jam", unique(df4$Main.cause), value = TRUE)] = "Ice Jams"
df4$Main.cause[df4$Main.cause %in% grep("^Dam", unique(df4$Main.cause), value = TRUE)] = "Dam"
df4$Main.cause[df4$Main.cause %in% grep("Torrential", unique(df4$Main.cause), value = TRUE)] = "Torrrential Rain"
df4$Main.cause[df4$Main.cause %in% grep("torrential", unique(df4$Main.cause), value = TRUE)] = "Torrrential Rain"
#Extract 11 Main causes
cause = c("Snow Melt","Heavy Rain","Rain and Snow Melt","Tropical","Typhoon","Monsoon","Hurricane","Ice Jams",
"Dam","Torrrential Rain")
MainCause = df4$Main.cause
df5 = df4[df4$Main.cause %in% cause,]
pca <- prcomp(df5[,c('Duration.in.Days','Dead','Displaced','Severity..', 'Affected.sq.km','Magnitude..M...','Centroid.X', 'Centroid.Y', 'M.6', 'M.4')],scale=TRUE,center=TRUE)
plot(pca, type = "l",main="All floods")
summary(pca)
g1 <- ggbiplot(pca, obs.scale = 1, var.scale = 1, groups = df5$Main.cause,
ellipse = TRUE, circle = TRUE)
g1 <- g1 + scale_color_discrete(name = '')
g1 <- g1 + theme(legend.direction = 'horizontal',
legend.position = 'top')
print(g1)
library(stats)
library(scales)
df2 = df[df[,'Year']==2003,]
df$Main.cause = as.factor(df$Main.cause)
df3 = df2
df3$Main.cause = as.character(df3$Main.cause)
df3$Main.cause[df3$Main.cause=='Rain and snow'] = "Rain and Snow Melt"
df3$Main.cause[df3$Main.cause=='Snowmelt'] = "Snow Melt"
MainCause = df3$Main.cause
pca <- prcomp(df3[,c('Duration.in.Days','Dead','Displaced','Severity..', 'Affected.sq.km','Magnitude..M...','Centroid.X', 'Centroid.Y', 'M.6', 'M.4')],scale=TRUE,center=TRUE)
plot(pca, type = "l",main="PCA for year 2003")
library(stats)
library(scales)
df2 = df[df[,'Year']==2003,]
df$Main.cause = as.factor(df$Main.cause)
df3 = df2
df3$Main.cause = as.character(df3$Main.cause)
df3$Main.cause[df3$Main.cause=='Rain and snow'] = "Rain and Snow Melt"
df3$Main.cause[df3$Main.cause=='Snowmelt'] = "Snow Melt"
MainCause = df3$Main.cause
pca <- prcomp(df3[,c('Duration.in.Days','Dead','Displaced','Severity..', 'Affected.sq.km','Magnitude..M...','Centroid.X', 'Centroid.Y', 'M.6', 'M.4')],scale=TRUE,center=TRUE)
plot(pca, type = "l",main="PCA for year 2003")
library(ggplot2)
library(maps)
library(grid)
library(gridExtra)
library(knitr)
library(googleVis)
library(gdata)
library(plyr)
library(dplyr)
library(wordcloud)
library(stringr)
library(tm)
library(chron)
setwd("/Users/bobminnich/Documents/Columbia/Courses/DataVisualization/Homework2/EDAV_Project2_Code")
df = readRDS("GlobalFloodsRecord_modified.rds")
View(df)
source('~/.active-rstudio-document', echo=TRUE)
colnames(df)
df = readRDS("GlobalFloodsRecord.rds")
View(df)
View(df)
df = readRDS("GlobalFloodsRecord.rds")
View(df)
